{% extends "_layout/index.html" %}
{% block style%}
<style>
    .sandbox-content{
        min-height: 50px;
        padding-left: 280px;
        padding-right: 280px;
        padding-top: 70px;
    }

    .works-list{font-size: 0;}

    .works-list > div{
        display: inline-block;
        width: 33.33%;
        padding-bottom: calc( 33.33% * 0.79 );
        position: relative;
    }

    .img-wrapper{
        position: absolute;
        top:6px;
        right: 6px;
        bottom: 6px;
        left: 6px;
    }

    .img-wrapper img{
        width: 100%;
        height: 100%;
    }

    .img-data{
        width: 100%;
        height: 100%;
        background-color: #d8d8d8;
    }
@media only screen and (max-width: 1200px) {
.sandbox-content {
padding-left: 150px;
padding-right: 150px;
}
}


@media only screen and (max-width: 768px) {
.sandbox-content {
padding-left: 80px;
padding-right: 80px;
}

    .works-list > div{
        display: inline-block;
        width: 50%;
        padding-bottom: calc( 50% * 0.79 );
        position: relative;
    }
}


@media only screen and (max-width: 480px) {

    .works-list > div{
        display: inline-block;
        width: 100%;
        padding-bottom: calc( 100% * 0.79 );
        position: relative;
    }

.sandbox{
    padding-left: 5px;
    padding-right: 5px;
}
.sandbox-content {
    padding-left: 5px;
    padding-right: 5px;
}
}

    .works-type{
        list-style: none;
        padding: 0px;
        font-size: 0;
        padding-bottom: 20px;
    }

    .works-type li a{
        font-family: FZLTXHB--B51-0;
        color: #666666;
        display: inline-block;
        width: 100%;
        height: 100%;
    }

    .works-type li a:hover{
        cursor: pointer;
        color: #FFD48B;
    }

    .works-type li:nth-child(1) a{
        color:#FFD48B;
    }

    .works-type li{display: inline-block;border: 1px solid #DDDDDD;padding: 2px 7px;min-width: 50px;text-align: center;font-size: 16px;margin-left: 6px;}

    h3{
        color: #ffffff;
        text-align: center;
        font-size: 28px;
    }

    .work-item-shade p{
        color:#ffffff;
        font-size: 14px;
        text-align: center;
    }
</style>
{% endblock %}
{% block pageTitle %}<div style="text-align: center;"><span style="line-height: 34px;font-size: 26px;font-family: FZLTXHB--B51-0;color: #333333;">WORKS</span></div>{% endblock %}
{% block body %}
<div class="sandbox-content">
<div class="works-menu">
    <ul class="works-type">
        <li><a>全部</a></li>
        <li><a>UI</a></li>
        <li><a>动效</a></li>
        <li><a>动画</a></li>
        <li><a>摄影</a></li>
    </ul>
</div>
<div class="works-list">
    <!--<div><div class="img-wrapper"><div class="img-data" img-data="http://zhuyan.me/img/example/1.jpg"/></div></div></div>-->
    <!--<div><div class="img-wrapper"><div class="img-data" img-data="http://zhuyan.me/img/example/2.jpg"/></div></div></div>-->
    <!--<div><div class="img-wrapper"><div class="img-data" img-data="http://zhuyan.me/img/example/3.jpg"/></div></div></div>-->
    <!--<div><div class="img-wrapper"><div class="img-data" img-data="http://zhuyan.me/img/example/4.jpg"/></div></div></div>-->
    <!--<div><div class="img-wrapper"><div class="img-data" img-data="http://zhuyan.me/img/example/1.jpg"/></div></div></div>-->
    <!--<div><div class="img-wrapper"><div class="img-data" img-data="http://zhuyan.me/img/example/2.jpg"/></div></div></div>-->
    <!--<div><div class="img-wrapper"><div class="img-data" img-data="http://zhuyan.me/img/example/3.jpg"/></div></div></div>-->
    <!--<div><div class="img-wrapper"><div class="img-data" img-data="http://zhuyan.me/img/example/4.jpg"/></div></div></div>-->
</div>
</div>
{% endblock %}

{% block script %}
<script src="/public/assets/js/imgLiquid.js"></script>
<script>
    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]); return null;
    }


    /*加载works*/
    function refreshWork(){
        $.ajax({
            url:'/worklist',
            data:{id:getQueryString('id')},
            dataType:'json',
            success:function(data){
                if(data.status){
                    var listItem = '';
                    console.log(data.data);
                    $.each(data.data,function(key,val){
                        listItem += '<div><div class="img-wrapper" data-title="'+val.title+'" data-abstract="'+val.abstract+'" data-id='+val.id+'><div class="img-data" img-data="'+val.face_img+'"/></div></div></div>';
                    });
//                    for(var item  in data.data){
//                        console.log(item);
//                        listItem += '<div><div class="img-wrapper"><div class="img-data" img-data="'+item.face_img+'"/></div></div></div>';
//                    }
                    $('.works-list').append(listItem);


                    $('.img-data').each(function(){
                        var src = $(this).attr('img-data');
                        $(this).replaceWith('<img class="work-item" src="'+src+'"/>');
                    });

                    $(".img-wrapper").imgLiquid();
//                    var afterHtml = '';
//                    var imgArr = data.data.imgs.split(',');
//                    console.log(imgArr);
//                    $.each(imgArr,function(ind,obj){
//                        afterHtml += '<img style="max-width: 100%;margin-bottom:28px;" src="'+obj+'">';
//                    });
//                    $('#work-panel').html(afterHtml);
//                    $('#work-title').html(data.data.title);
                }
            },
            error:function(){
            }
        });
    }



    $(function(){
//        $('.img-data').each(function(){
//            var src = $(this).attr('img-data');
//            $(this).replaceWith('<img class="work-item" src="'+src+'"/>');
//        });
//
//        $(".img-wrapper").imgLiquid();

        $('body').on('mouseover','.img-wrapper',function(){
            if($(this).find('.work-item-shade').length){
                return;
            }else{
                $(this).append('<div class="work-item-shade" style="position:absolute;top:0;right:0;bottom:0;left:0;z-index:99;background-color:#000000;opacity: .6;"><div style="display: table;height: 100%;width: 100%;"><div style="display: table-cell;vertical-align: middle"><h3>'+$(this).attr('data-title')+'</h3><p>'+$(this).attr('data-abstract')+'</p></div></div></div>');
                return;
            }
        });


        $('body').on('mouseleave','.img-wrapper',function(){
//            console.log(4);
            $(this).find('.work-item-shade').remove();
        });

        $('body').on('click','.img-wrapper',function(){
            location.href = '/work?id=' + $(this).attr('data-id');
        })

        refreshWork();
    });
</script>
{% endblock %}